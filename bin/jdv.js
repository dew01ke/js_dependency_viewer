#!/usr/bin/env node
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=require("path")},function(e,t){e.exports={PACKAGE_NAME:"js-dependency-viewer",PATTERN_IMPORT:/import\s(?:{)*(.*?)(?:})*\sfrom\s(?:"|')(.*)(?:"|')/gi,COLORS:{default:"[33m",reset:"[0m",error:"[31m",base:"[37m",success:"[32m"},DEFAULT_PACKAGE_JSON:"package.json",DEFAULT_NODE_MODULES:"node_modules",DEFAULT_EXTENSIONS:[".vue",".js",".ts",".js6",".es6"]}},function(e,t,n){const{COLORS:r,PACKAGE_NAME:o}=n(1),i={info:(...e)=>console.log(r.default,`[${o}]:`,e.join(" "),r.reset),success:(...e)=>console.log(r.success,`[${o}]:`,e.join(" "),r.reset),error:(...e)=>console.log(r.error,`[${o}]:`,e.join(" "),r.reset)};e.exports={join:function(e,t){return t.reduce((t,n,r)=>(t[e[r]]=n,t),{})},log:i,flatten:function(e){return[].concat.apply([],e)},safeJSONParse:function(e){let t={};try{t=JSON.parse(e)}catch(e){}return t},splitNames:function(e){return e.split(",")},filterExternalDependencies:function(e){return e.filter(e=>!/^\./.test(e.module))},asyncReduce:async function(e,t,n){let r=n;for(value of e)r=await t(r,value);return r},buildExtensionsArray:function(e){return e.replace(/["|']/g,"").split(",").map(e=>{const t=e.trim();return t.startsWith(".")?t:`.${t}`})}}},function(e,t,n){const{promisify:r}=n(8),{resolve:o}=n(0),i=n(0),s=n(9),a=r(s.readdir),c=r(s.stat),u=r(s.readFile),l=r(s.writeFile),{DEFAULT_NODE_MODULES:f}=n(1);e.exports={getFileSize:function(e){return c(e).then(e=>e.size).catch(()=>0)},getFiles:async function e(t,n=[f]){const r=await a(t);return(await Promise.all(r.map(async r=>{const i=o(t,r);return n.includes(r)?"":(await c(i)).isDirectory()?e(i):i}))).reduce((e,t)=>e.concat(t),[])},getContent:async function(e){return{relativePath:e,filename:i.relative(process.cwd(),e),content:await u(e,{encoding:"utf8"})}},saveData:function(e,t){return l(e,t,"utf8")},isExists:async function(e){let t=!1;try{await c(e),t=!0}catch(e){}return t}}},function(e,t,n){const r=n(0),{getFiles:o,getContent:i}=n(3),{parseContent:s}=n(10),{flatten:a,filterExternalDependencies:c}=n(2),{DEFAULT_EXTENSIONS:u}=n(1);e.exports={getDependenciesObject:function(e,t,n=!0){return o(e).then(function(e=u){return t=>t.filter(t=>e.includes(r.extname(t)))}(t)).then(async e=>await Promise.all(e.map(e=>i(e)))).then(e=>e.map(({content:e,filename:t,relativePath:n})=>s(e,t,n))).then(a).then(e=>n?c(e):e)}}},function(e,t,n){(function(e){const{find:t}=n(7),{frequencyDependencies:r}=n(11),{saveData:o}=n(3),{log:i,buildExtensionsArray:s}=n(2),a=!e.parent,c=process.argv.slice(2),u={mode:"d"};if(c.forEach(e=>{const[t,n]=e.split("=");switch(t){case"--target":u.target=n;break;case"--out":u.out=n;break;case"--mode":u.mode=["d","f"].includes(n.toLowerCase())?n:"d";break;case"--ext":const e=s(n);e.length&&(u.extensions=e);break;default:i.info("Unknown parameter = "+t)}}),a)if(u.target)switch(i.info("Processing... Target path = "+u.target),u.mode){case"f":r(u.target,u.extensions).then(e=>{if(!e)return!1;i.success(JSON.stringify(e))});break;case"d":default:t(u.target,u.extensions).then(e=>!!e&&(Array.isArray(e)&&!e.length?i.info("No external dependencies found"):u.out?o(u.out,JSON.stringify(e)).then(()=>{i.success("The result has been save to "+u.out)}):void i.success(JSON.stringify(e))))}else i.error("One or more required parameters are missing");process.on("unhandledRejection",e=>{i.error("Ooops, unhandled rejection",e)}),e.exports={find:t,frequencyDependencies:r}}).call(this,n(6)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){const r=n(0),{getDependenciesObject:o}=n(4),{getFiles:i,getContent:s,isExists:a,getFileSize:c}=n(3),{safeJSONParse:u,asyncReduce:l,log:f,join:d}=n(2),{DEFAULT_PACKAGE_JSON:p,DEFAULT_NODE_MODULES:m}=n(1);async function h(e="./"){return s(r.join(e,p)).then(({content:e})=>u(e)).then(e=>e.dependencies||{}).then(function(e){return async t=>{if(!await a(r.resolve(e,m)))return f.info(`Make sure you run 'npm install' in ${e} folder`),Object.keys(t).reduce((e,t)=>(e[t]=null,e),{});const n=Object.keys(t),o=n.map(t=>r.resolve(e,m,t)),s=await Promise.all(o.map(e=>i(e))),u=await Promise.all(s.map(e=>l(e,async(e,t)=>e+=await c(t),0)));return d(n,u)}}(e))}e.exports={find:async function(e,t){if(!await a(e))return f.error("Target path does not exist");if(!await a(r.join(e,p)))return f.error("Target path should contain a valid package.json");const n=await h(e),i=await o(e,t),s={};return i.forEach(e=>{if(!n.hasOwnProperty(e.module))return;const t=e.module;s[t]||(s[t]={module:e.module,methods:{}},n[e.module]&&(s[t].size=n[e.module]));const r=`${e.module}_${e.originalName}`;s[t].methods[r]||(s[t].methods[r]={name:e.originalName,location:[]}),s[t].methods[r].location.push(e.filename)}),Object.values(s).map(e=>({...e,methods:Object.values(e.methods)}))}}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("fs")},function(e,t,n){const r=n(0),{PATTERN_IMPORT:o}=n(1),{flatten:i,splitNames:s}=n(2);function a(e){const t=e.trim().split(" as ");return{originalName:t[0],shadowName:t[1]||null}}e.exports={parseContent:function(e,t,n){return i(function(e,t,n){return e.map(e=>{return s(e.name).map(o=>({...a(o),...e,filename:t,relativePath:n,resolvedPath:e.module.startsWith(".")?r.resolve(n+"/..",e.module):null}))})}(function(e,t){let n,r=[];for(;n=t.exec(e);){const[e,t,o]=n;r.push({name:t,module:o})}return r}(e,o),t,n))}}},function(e,t,n){const{getDependenciesObject:r}=n(4);e.exports={frequencyDependencies:function(e,t){return r(e,t,!1).then(e=>e.reduce((e,t)=>(e[t.resolvedPath]||(e[t.resolvedPath]=0),e[t.resolvedPath]+=1,e),{}))}}}]);